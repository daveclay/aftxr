
<html>
<head>
    <meta name="viewport"
          content="user-scalable=no, initial-scale=1, maximum-scale=1, minimum-scale=1, width=device-width, height=device-height, target-densitydpi=device-dpi"/>
    <meta name="apple-mobile-web-app-status-bar-style" content="black" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <link rel="shortcut icon" href="icon.ico">
    <link href='http://fonts.googleapis.com/css?family=Abel|Roboto+Condensed' rel='stylesheet' type='text/css'>
    <!-- <link href='http://fonts.googleapis.com/css?family=Ropa+Sans|Metrophobic|Allerta+Stencil' rel='stylesheet' type='text/css'> -->
    <link rel="stylesheet" type="text/css" href="css/aftxr.css"/>
</head>
<body>
<div id="logo">aftxr.com</div>
<div id="stage"></div>
<div id="progress"><div id="meter"></div></div>
<div id="info"></div>

<script type="text/javascript">

    var bits = 125;
    var counter = 0;
    var logo = document.getElementById("logo");
    var stage = document.getElementById("stage");
    var info = document.getElementById("info");
    var progress = document.getElementById("progress");
    var meter = document.getElementById("meter");


    function mutate() {
        setTimeout(function() {
            moveAll();
            mutate();
        }, Math.round(Math.random() * 2000) + 2000);
    }

    function moveAll() {
        var imgs = document.getElementsByTagName("img");
        for (var i = 0; i < imgs.length; i++) {
            var img = imgs[i];
            if (img.className == 'bit') {
                move(img);
            }
        }
    }

    function move(img) {

        var entityLocation = {
            y: function() {
                var center = window.innerHeight / 2;
                var range = window.innerHeight / 6;
                var amount = range / 3 - Math.round(Math.random() * range);
                return center + amount;
            },
            x: function() {
                var center = window.innerWidth / 2;
                var range = window.innerWidth / 3;
                var amount = range / 2 - Math.round(Math.random() * range);
                return center + amount;
            }
        };

        setTimeout(function() {
            var scale = (Math.round(Math.random() * 70) + 30) / 100;
            var rotate = Math.round(Math.random() * 180);
            var opacity = (Math.round(Math.random() * 95) + 5) / 100;
            var x = entityLocation.x() + "px";
            var y = entityLocation.y() + "px";
            img.style.transformOrigin = x + " " + y;
            img.style.transform = "rotate(" + rotate + "deg) scale(" + scale + ") translate3d(" + x + ", " + y + ", 0)";
            img.style.opacity = opacity;
            img.style.zIndex = Math.round(Math.random() * 100);
        }, Math.round(Math.random() * 500));
    }

    function updateProgress() {
        counter++;
        var percent = Math.round(counter / bits * 100) + "%";
        meter.style.width = percent;
        info.innerText = percent;
        if (percent === "100%") {
            meter.style.display = "none";
            progress.style.display = "none";
            info.style.display = "none";
        }
    }

    function initialize() {
        for (var i = 1; i <= bits; i++) {
            var img = document.createElement("img");
            img.src = "images/orig-bits/"+ i + ".png";
            img.className = "bit";
            img.onload = function() {
                updateProgress();
            };
            stage.appendChild(img);
        }
    }

    initialize();
    moveAll();
    mutate();

    setInterval(function() {
        logo.innerText = "aftxr.+" + Math.round(Math.random() * 100000);
    }, 100);
</script>
</body>
</html>
